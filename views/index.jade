extends layout

block content
  .layui-container
    .layui-row
      .layui-col-xs12.layui-col-md12
        br
        h1 #{classId}ç­é’å¹´å¤§å­¦ä¹ æˆªå›¾æ”¶é›†â€”â€”#{task.name}
        br
        hr.layui-bg-red
        .layui-elem-quote 
          p å¦‚æœè¿™ä¸æ˜¯ä½ çš„ç­çº§ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹åœ°å€æ ä¸­çš„#{classId}
          p æˆ–è€…ï¼Œ
            a(href="/" style="color:#FF5722") è¿”å›ä¸»é¡µ
        br
        hr.layui-bg-red
    .layui-row.layui-col-space16 
      .layui-col-xs12.layui-col-md6
        form.layui-form(action='/upload', method='post', enctype='multipart/form-data')
          input(type='hidden',name="classId" value=classId)
          .layui-form-item
            label.layui-form-label å§“åï¼š
            .layui-input-block
              input.layui-input(type="text" name="name" required  lay-verify="required" placeholder="åŠ¡å¿…è¾“å…¥çœŸå®å§“å" autocomplete="off")
          .layui-form-item
            label.layui-form-label ä¿¡æ¯ç•Œé¢ï¼š
            .layui-input-block
              input(type='file', name='info-img' required  lay-verify="required")
          .layui-form-item
            label.layui-form-label å®Œæˆç•Œé¢ï¼š
            .layui-input-block
              input(type='file', name='finish-img' required  lay-verify="required")
          .layui-form-item#progress(hidden)
            .layui-input-block
              .layui-progress.layui-progress-big(lay-showPercent="true" lay-filter="demo")
                .layui-progress-bar.layui-bg-blue(lay-percent="0%")
          .layui-form-item#submit-btn
            .layui-input-block
              button.layui-btn(lay-submit) æäº¤
        br
      .layui-col-xs12.layui-col-md6
        fieldset.layui-elem-field
          legend æ›´æ–°~~
          .layui-field-box
            p è¿ç»­ä¸¤ä¸ªæœˆï¼Œæ¯æ¬¡éƒ½è¦å‚¬æ— æ•°é
            br
            p æ¯æ¬¡åˆšå¥½æœ‰ä¸”ä»…æœ‰ä¸€äººä¸äº¤ï¼Œè¿™ä¸ªäººï¼Œæ¯å‘¨è¿˜éƒ½ä¸ä¸€æ ·
            br
            p æˆ‘æ„¿ç§°å…¶ä¸ºã€Š1706ç­æœ€åä¸€äººæ‰“æ­»ä¹Ÿä¸äº¤æˆªå›¾å®šå¾‹ã€‹
            br
            p æ¯”è¾ƒå¥½å¥‡ä»–ä»¬éƒ½æ˜¯è°ï¼Œæ‰€ä»¥ä¸´æ—¶åŠ æ›´äº†ä¸€ä¸ªå°ç»Ÿè®¡
            br
            p å› ä¸ºæ—¶å·®é—®é¢˜ï¼Œæœ‰å¯èƒ½ä¸å‡†ç¡®ï¼ˆææœ‰å¯èƒ½ï¼‰
            br
            p æ— æ¶æ„ï¼Œä»…ä»…æ»¡è¶³æˆ‘çš„å¥½å¥‡å¿ƒ
            br
        br
        hr.layui-bg-red
        fieldset.layui-elem-field
          legend éœ‡æƒŠï¼æŸä¸‰æ— ç½‘ç«™ç»ˆäºä¿®å¤äº†è¿™ä¸ªåŠŸèƒ½
          .layui-field-box
            p æŸåŒå­¦ç»ˆäºæƒ³èµ·äº†è¿™ä¸ªä¸Šä¼ æ— å“åº”çš„bug
            br
            p åŠ äº†ä¸€ä¸ªè¿›åº¦æ¡ âŠ™â–½âŠ™
            br
            p åº”è¯¥ä¸ä¼šæœ‰åœ°çƒäººğŸŒå†æŠŠæˆªå›¾ä¸Šä¼ N+1éäº†
            br
            p PSï¼šæœ¬æ¥æƒ³å†™ä¸ªå‡è¿›åº¦æ•·è¡ä¸€ä¸‹ï¼Œç„¶åå‘ç°ï¼Œå‡çš„å’ŒçœŸçš„ä»£ç é‡å·®ä¸å¤š (â€²â–½`ã€ƒ)
            br
        br
        hr.layui-bg-red
        fieldset.layui-elem-field
          legend 
            del å…³äºæäº¤åç½‘é¡µæ²¡æœ‰ååº”çš„è¯´æ˜
          .layui-field-box
            p 
              del éƒ¨åˆ†åŒå­¦ååº”ï¼Œç‚¹å‡»æäº¤åç½‘é¡µæ²¡æœ‰ååº”
            br
            p 
              del emmm å¥½å§ï¼Œè¿™ä¸ªç°è±¡ç¡®å®å­˜åœ¨
            br
            p 
              del å› ä¸ºæœåŠ¡å™¨åœ¨å›½å¤–ï¼Œæˆªå›¾ä¸Šä¼ ä¸€èˆ¬è¦3-5ç§’ï¼Œåœ¨æ­¤æœŸé—´ï¼Œç½‘é¡µä¸ä¼šä»»ä½•åé¦ˆ
            br
            p 
              del æ‰€ä»¥è€å¿ƒç­‰å¾…å³å¯ï¼Œä¸Šä¼ æˆåŠŸåä¼šè‡ªåŠ¨è·³è½¬
            br
            p 
              del è¿™ä¸ªbugä¼šåœ¨ä¸ä¹…çš„å°†æ¥ä¿®å¤ï¼Œå…·ä½“æ—¶é—´çœ‹å¿ƒæƒ… (â€²â–½`ã€ƒ)
            br
        br
        hr.layui-bg-red
        fieldset.layui-elem-field
          legend æœ‰å¿…è¦åæ§½ä¸€ä¸‹
          .layui-field-box
            p æ˜¨å¤©ï¼ˆ2020.09.27ï¼‰åŠ å…¥äº†æ–°ç­çº§ã€‚
            br
            p ä»Šå¤©ï¼Œç½‘ç«™å‡ºç°äº†å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„åå­—ã€‚
            br
            p è¿™å±Šç½‘å‹å¥½ä¼˜ç§€å•Šã€‚
            br
            p å› ä¸ºæˆ‘æ¯”è¾ƒæ‡’ï¼Œé™¤äº†é‚£ä¸ªidä¸ºã€åå­—è¶Šé•¿è¶Šç‰›é€¼ã€‘æ¡ç›®ï¼ˆå› ä¸ºidå®åœ¨å¤ªç‰¹ä¹ˆé•¿äº†ï¼Œå‹ç¼©åŒ…æ— æ³•è§£å‹ï¼‰ï¼Œå’Œã€111...111ã€‘ï¼ˆå½±å“ç½‘é¡µæ˜¾ç¤ºï¼‰å¤–ã€‚
            br
            p å…¶ä»–æ•°æ®å°±ä¸åˆ äº†ï¼Œç•™ç€ï¼Œé­å°¸ã€‚
            br
            p ç½‘ç«™çš„æ­£å¸¸åŠŸèƒ½ä¸å—å½±å“ï¼Œå°±æ˜¯å›¢æ”¯ä¹¦ä¸‹è½½æ–‡ä»¶åè¦æ‰‹åŠ¨åˆ é™¤åƒåœ¾æ¡ç›®ã€‚
            br
        br
        hr.layui-bg-red
        fieldset.layui-elem-field
          legend ä¸€äº›é—®ç­”ï¼š
          .layui-field-box
            p é¡µé¢å¥½æ¡æ¼å•Š
            p â€”â€”æˆ‘ï¼Œç©·ï¼Œè¯·ï¼Œæ‰“é’±ï¼Œè°¢è°¢ã€‚
            br
            p æˆ‘å¼€å¤šçº¿ç¨‹è½¬é¡µé¢ä¼šè¹¦å—ï¼Ÿ
            p â€”â€”ä¼šçš„ï¼Œä½†æ˜¯åªè¦é‡å¯å¾—å¤Ÿå¿«ï¼Œå°±æ²¡äººçŸ¥é“æˆ‘å´©äº†
            br
            p ä½ å¥½å‘€
            p â€”â€”æœ¬æ¥æŒºå¥½ï¼Œç°åœ¨å¥½å¿ƒæƒ…éƒ½ä¹ˆå¾—äº†
            br
            p åå­—æ€ä¹ˆä¸éªŒè¯ï¼Ÿ
            p â€”â€”è¿™ã€‚ã€‚æˆ‘ä¹Ÿæ²¡æƒ³åˆ°ä½ ä»¬è¾£ä¹ˆä¼˜ç§€
            br
            p ä½ ç¡®å®š3-5ç§’å°±è¡Œäº†å˜›
            p â€”â€”æ˜¯çš„ï¼Œæˆ‘ç¡®å®šï¼Œä½†æ˜¯æ™šä¸Šç”¨ç½‘é«˜å³°ä»¥åŠäººå“ä¸å¥½çš„æ—¶å€™ï¼Œç½‘é€Ÿä¼šè¢«æ‹‰ä½ã€‚
            br

  script.
    //- layui.use('form', function(){
    //- var form = layui.form;
    
    //- //å„ç§åŸºäºäº‹ä»¶çš„æ“ä½œï¼Œä¸‹é¢ä¼šæœ‰è¿›ä¸€æ­¥ä»‹ç»
    //- });

    var element=null;
    layui.use('element', function(){
      element = layui.element;
    });
    $('form').on('submit', function (e) {
        e.preventDefault(); 
        $("#submit-btn").hide();
        $("#progress").show();
        let fd = new FormData(this); 
        $.ajax({
            type: 'POST',
            url: '/upload',
            data: fd,
            //- dataType:'json',
            contentType: false,
            processData: false, 
            xhr: function () { 
                let xhr = new XMLHttpRequest();
                if (xhr.upload) {
                  xhr.upload.addEventListener('progress', jdt, false);
                }
                return xhr; 
            },
            success: function (res) { 
                //- console.log(res);
                $(location).attr('href', '/info/classId/#{classId}');
              },
              beforesend:function(){},
              complete:function(){},  
        })
    })
    function jdt(e){
        //- $('progress').attr('max',e.total); 
        //- $('progress').attr('value',e.loaded);
        element.progress('demo', parseInt(e.loaded*100/e.total)+'%');

    }

